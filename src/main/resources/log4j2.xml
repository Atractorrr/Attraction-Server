<?xml version="1.0" encoding="UTF-8"?>
<Configuration>
    <Properties>
        <!-- 로그 파일 디렉토리 경로 -->
        <Property name="LOG_FILE_PATH">./logs</Property>
        <!-- 로그 패턴 -->
        <property name="LOG_PATTERN"
                  value="[%equals{%X{request_id}}{}{startup}] %d{HH:mm:ss.SSS} [%t] %-5level %logger{36} - %msg%n"/>
    </Properties>

    <Appenders>
        <!-- 콘솔 로그-->
        <Console name="Console-Appneder" target="SYSTEM_OUT" follow="true">
            <PatternLayout pattern="${LOG_PATTERN}"/>
        </Console>

        <!-- 로그 파일-->
        <RollingFile name="File-Appneder" fileName="${LOG_FILE_PATH}/log.log"
                     filePattern="${LOG_FILE_PATH}/%d{yyyy-MM-dd}.log.zip">
            <PatternLayout pattern="${LOG_PATTERN}"/>
            <Policies>
                <SizeBasedTriggeringPolicy size="15MB"/>
                <TimeBasedTriggeringPolicy interval="1" modulate="true"/>
            </Policies>
            <DefaultRolloverStrategy>
                <Delete basePath="${LOG_FILE_PATH}">
                    <IfAccumulatedFileCount exceeds="4"/>   <!-- log 파일이 4개 이상일때 예전 log 파일 삭제 -->
                    <IfFileName glob="*.log"/>   <!-- 삭제할 파일명 -->
                    <IfLastModified age="3d"/>   <!-- 3일이 경과한 로그파일은 자동 삭제 -->
                </Delete>
            </DefaultRolloverStrategy>
        </RollingFile>
    </Appenders>

    <Loggers>
        <Root level="INFO">
            <AppenderRef ref="Console-Appneder"/>
        </Root>

        <!-- 내 패키지에서 발생하는 log 출력 -->
        <Logger name="run.attraction" level="info" additivity="false">
            <AppenderRef ref="File-Appneder"/>
        </Logger>
    </Loggers>
</Configuration>